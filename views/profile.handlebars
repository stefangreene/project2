{{!-- adding profile view for testing --}}

{{!-- Button to test the modal triggering --}}
<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#profileUpdateModal">
  Modal Testing
</button>

{{!-- The profile modal --}}
<div class="modal fade" id="profileUpdateModal" tabindex="-1" role="dialog" aria-labelledby="profileUpdateModalTitle"
  aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="profileUpdateModalTitle">User Profile</h5>
      </div>
      <div class="modal-body" id="profileUpdateModalBody">

        {{!-- First Name --}}
        <label for="firstNameInput">First Name: </label>
        <input id="firstNameInput" name="firstNameInput" type="text" />
        <button id="firstNameUpdate" class="btn btn-primary btn-sm">Update</button>
        <br>

        {{!-- Last Name --}}
        <label for="lastNameInput">Last Name: </label>
        <input id="lastNameInput" name="lastNameInput" type="text" />
        <button id="lastNameUpdate" class="btn btn-primary btn-sm">Update</button>
        <br>

        {{!-- email address --}}
        <label for="emailInput">Email: </label>
        <input id="emailInput" name="emailInput" type="text" />
        <button id="emailUpdate" class="btn btn-primary btn-sm">Update</button>
        <br>

        {{!-- password update --}}

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>


<script>
  $(document).ready(function () {
    const modalTitleEl = $("#profileUpdateModalTitle");
    const modalBodyEl = $("#profileUpdateModalBody");

    const firstNameInput = $("#firstNameInput");
    const firstNameUpdateBtn = $("#firstNameUpdate");

    const lastNameInput = $("#lastNameInput");
    const lastNameUpdateBtn = $("#lastNameUpdate");

    const emailInput = $("#emailInput");
    const emailUpdateBtn = $("#emailUpdate");

    refresh();

    $(firstNameUpdateBtn).click(function () {
      const myUpdate = $(firstNameInput).val();
      if (myUpdate) {
        $.ajax({
          url: '/api/profile',
          type: 'post',
          data: {
            firstname: myUpdate,
          },
          success: function (data, textStatus, jQxhr) {
            refresh();
          },
          error: function (jqXhr, textStatus, errorThrown) {
            console.log(errorThrown);
          }
        });
      } else {
        alert("Please input a value to update");
      }
    });

    $(lastNameUpdateBtn).click(function () {
      const myUpdate = $(lastNameInput).val();
      if (myUpdate) {
        $.ajax({
          url: '/api/profile',
          type: 'post',
          data: {
            lastname: myUpdate,
          },
          success: function (data, textStatus, jQxhr) {
            refresh();
          },
          error: function (jqXhr, textStatus, errorThrown) {
            console.log(errorThrown);
          }
        });
      } else {
        alert("Please input a value to update");
      }
    });

    $(emailUpdateBtn).click(function () {
      const myUpdate = $(emailInput).val();
      if (myUpdate) {
        $.ajax({
          url: '/api/profile',
          type: 'post',
          data: {
            email: myUpdate,
          },
          success: function (data, textStatus, jQxhr) {
            refresh();
          },
          error: function (jqXhr, textStatus, errorThrown) {
            console.log(errorThrown);
          }
        });
      } else {
        alert("Please input a value to update");
      }
    });

  }); // closes the .ready(function() {

  let refresh = function () {
    $(firstNameInput).val("");
    $(lastNameInput).val("");
    $(emailInput).val("");

    $.ajax({
      url: "api/profile",
      type: "GET"
    }).then(function (result) {
      console.log(result);
      $(firstNameInput).attr("placeholder", result.firstname);
      $(lastNameInput).attr("placeholder", result.lastname);
      $(emailInput).attr("placeholder", result.email);

    });
  };

</script>